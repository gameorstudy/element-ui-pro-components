(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t():"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["index"]=t():e["index"]=t()})("undefined"!==typeof self?self:this,function(){return function(){"use strict";var e={};!function(){e.d=function(t,n){for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})}}(),function(){e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){e.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){e.p=""}();var t={};if(e.r(t),e.d(t,{default:function(){return De}}),"undefined"!==typeof window){var n=window.document.currentScript,o=n&&n.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);o&&(e.p=o[1])}var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"pro-table"},[e.search?[t("el-form",{staticClass:"pro-table__form",class:e.searchProps.className,attrs:{"label-width":e.searchProps.labelWidth,"label-position":e.searchProps.labelPosition,model:e.form,size:e.defaultSize}},[t("el-row",e._b({},"el-row",e.searchProps.rowProps,!1),[e._l(e.formItems,function(n,o){return t("el-col",e._b({key:n.prop??e.getUID(),style:{display:o>=e.searchCount?"none":""}},"el-col",e.searchProps.colProps,!1),[t("ProFormItem",{attrs:{form:e.form,formItem:n},scopedSlots:e._u([{key:n.prop,fn:function(){return[e._t(n.prop,null,null,{form:e.form,formItem:n})]},proxy:!0}],null,!0)})],1)}),t("el-col",e._b({key:"search",staticStyle:{display:"flex","align-items":"center","justify-content":"flex-end"}},"el-col",e.searchColConfig,!1),[t("el-button",{attrs:{icon:"el-icon-refresh",size:e.defaultSize},on:{click:e.handleReset}},[e._v(e._s(e.searchProps.resetText))]),t("el-button",{attrs:{type:"primary",icon:"el-icon-search",loading:e.loading,size:e.defaultSize},on:{click:e.handleSearch}},[e._v(e._s(e.searchProps.searchText))]),e.showExpandToggle?[t("el-button",{staticClass:"btn-collapse",attrs:{type:"text",size:e.defaultSize},on:{click:e.handleCollapse}},[e._v(" "+e._s(e.collapsed?"展开":"收起")+" "),t("ArrowIcon",{staticStyle:{transition:"0.3s"},style:{transform:`rotate(${e.collapsed?0:.5}turn)`}})],1)]:e._e()],2)],2)],1)]:e._e(),e.$slots.default||e.columnSettings?t("div",{staticClass:"pro-table__toolbar"},[e._t("default"),e.columnSettings?t("div",{staticClass:"pro-table__toolbar-items"},[t("ColumnSettings",{attrs:{columns:e.settingColumns,columnSettings:e.initializedColumnSettings}})],1):e._e()],2):e._e(),t("el-table",e._g(e._b({directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.tableKey,ref:"tableRef",staticClass:"pro-table__table",class:e.className,attrs:{data:e.dataSource}},"el-table",e.initializedTableProps,!1),e.initializedTableEvents),e._l(e.normalizedColumns,function(n){return t("el-table-column",e._b({key:n.prop||n.nonElColumnProps.key,scopedSlots:e._u([n.nonElColumnProps.renderCellHeader?{key:"header",fn:function(e){return[t("CustomRender",{attrs:{render:()=>n.nonElColumnProps.renderCellHeader(e)}})]}}:null,n.nonElColumnProps.renderCell?{key:"default",fn:function(e){return[t("CustomRender",{attrs:{render:()=>n.nonElColumnProps.renderCell(e)}})]}}:n.nonElColumnProps.valueEnum?{key:"default",fn:function(o){return[t("span",[e._v(" "+e._s(n.nonElColumnProps.valueEnum instanceof Map?n.nonElColumnProps.valueEnum.get(o.row?.[n.prop]):n.nonElColumnProps.valueEnum[o.row?.[n.prop]])+" ")])]}}:null],null,!0)},"el-table-column",{...n,nonElColumnProps:void 0},!1))}),1),t("el-pagination",e._b({staticClass:"pro-table__pagination",on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}},"el-pagination",e.initializedPaginationProps,!1))],2)},r=[];function s(e){switch(e){case"input":case"input-number":return"请输入";case"select":case"time-picker":case"date-picker":case"cascader":return"请选择";default:return""}}function i(e,t){e.placeholder=e.placeholder??s(t)}function a(e,t){const{valueType:n,prop:o,options:l,valueEnum:r,optionLoader:s}=e;"select"===n&&(l?.length>0||(r?r instanceof Map?e.options=Array.from(r,([e,t])=>({label:t,value:e})):e.options=Object.entries(r).map(([e,t])=>({label:t,value:e})):e.options=s&&t[o]?t[o]:[]))}function c(e,t,n){const{valueType:o,prop:l,optionLoader:r}=t;"cascader"===o&&(e.options?.length>0||r&&n[l]&&(e.options=n[l]))}const u={xs:0,sm:768,md:992,lg:1200,xl:1920},p=24,d={xs:24,sm:24,md:12,lg:8,xl:6},m=["xl","lg","md","sm","xs"],h=e=>e>=u.xl?"xl":e>=u.lg?"lg":e>=u.md?"md":e>=u.sm?"sm":"xs",g=e=>{const t=h(window.innerWidth),n=m,o=n.indexOf(t);for(let l=o;l<n.length;l++){const t=n[l];if(e[t])return e[t]}return e.span||p},f=(e,t=150)=>{let n;const o=(...o)=>{n&&clearTimeout(n),n=setTimeout(()=>{e.apply(void 0,o)},t)};return o.cancel=function(){n&&(clearTimeout(n),n=null)},o};function b(){if("undefined"!==typeof crypto&&crypto.randomUUID)return crypto.randomUUID();const e=new Uint8Array(16);return crypto.getRandomValues(e),Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}var C,x,v=function(){var e=this,t=e._self._c;return t("el-form-item",e._b({scopedSlots:e._u([e.formItem.renderLabel?{key:"label",fn:function(){return[t("CustomRender",{attrs:{render:e.formItem.renderLabel}})]},proxy:!0}:null],null,!0)},"el-form-item",e.normalizedFormItem,!1),[e.formItem.renderField?t("CustomRender",{attrs:{render:()=>e.formItem.renderField({form:e.form,formItem:e.formItem})}}):"slot"===e.formItem.valueType?e._t(e.formItem.prop):t(`el-${e.formItem.valueType}`,e._g(e._b({tag:"component",model:{value:e.form[e.formItem.prop],callback:function(t){e.$set(e.form,e.formItem.prop,t)},expression:"form[formItem.prop]"}},"component",e.formItem.fieldProps,!1),e.formItem.fieldEvents),["select"===e.formItem.valueType?[e.formItem.options?.[0]?.options?e._l(e.formItem.options,function(n){return t("el-option-group",e._b({key:n.label},"el-option-group",n,!1),e._l(n.options,function(n){return t("el-option",e._b({key:n.value},"el-option",n,!1))}),1)}):e._l(e.formItem.options,function(n){return t("el-option",e._b({key:n.value},"el-option",n,!1))})]:e.groups.includes(e.formItem.valueType)?e._l(e.formItem.options,function(n){return t(e.selection[e.formItem.valueType],{key:n.value,tag:"component",attrs:{label:n.value}},[e._v(" "+e._s(n.label)+" ")])}):e._e()],2)],2)},y=[],S={name:"CustomRender",props:{render:{type:Function,required:!0}},render:function(e){return e("Fragment",[this.render()])}},_=S;function w(e,t,n,o,l,r,s,i){var a,c="function"===typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=n,c._compiled=!0),o&&(c.functional=!0),r&&(c._scopeId="data-v-"+r),s?(a=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),l&&l.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},c._ssrRegister=a):l&&(a=i?function(){l.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:l),a)if(c.functional){c._injectStyles=a;var u=c.render;c.render=function(e,t){return a.call(t),u(e,t)}}else{var p=c.beforeCreate;c.beforeCreate=p?[].concat(p,a):[a]}return{exports:e,options:c}}var I=w(_,C,x,!1,null,"2ddfacb0",null),k=I.exports,P={name:"ProFormItem",components:{CustomRender:k},props:{formItem:{type:Object,required:!0},form:{type:Object,required:!0}},computed:{normalizedFormItem(){const{renderLabel:e,valueType:t,renderField:n,fieldProps:o,fieldEvents:l,options:r,valueEnum:s,optionLoader:i,initialValue:a,colProps:c,...u}=this.formItem;return u}},data(){return{groups:["radio-group","checkbox-group"],selection:{"radio-group":"el-radio","checkbox-group":"el-checkbox"}}}},z=P,R=w(z,v,y,!1,null,"19729659",null),T=R.exports,E=function(){var e=this,t=e._self._c;return t("svg",{attrs:{viewBox:"64 64 896 896",focusable:"false","data-icon":"down",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[t("path",{attrs:{d:"M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"}})])},A=[],L={name:"ArrowIcon"},O=L,j=w(O,E,A,!1,null,"03c6aa2a",null),D=j.exports,F=function(){var e=this,t=e._self._c;return t("el-popover",{attrs:{"popper-class":"column-settings-popover",placement:"bottom-end",trigger:"click"}},[t("div",{staticClass:"pro-table__toolbar-item",attrs:{slot:"reference"},slot:"reference"},[t("el-tooltip",{attrs:{content:e.columnSettings.settingText,placement:"top"}},[t("SettingIcon")],1)],1),t("div",{staticClass:"column-settings-popover-header"},[e.columnSettings.checkable?t("el-checkbox",{attrs:{value:e.checkAll,indeterminate:e.isIndeterminate},on:{change:e.handleChange}},[e._v(" "+e._s(e.columnSettings.settingText)+" ")]):t("span",[e._v(e._s(e.columnSettings.settingText))]),t("el-button",{attrs:{type:"text"},on:{click:e.handleReset}},[e._v(e._s(e.columnSettings.resetText))])],1),t("div",{staticClass:"column-settings-popover-content"},[t("ColumnSettingsItem",{attrs:{columns:e.leftFixedColumns,columnSettings:e.columnSettings}}),t("ColumnSettingsItem",{attrs:{columns:e.noFixedColumns,columnSettings:e.columnSettings}}),t("ColumnSettingsItem",{attrs:{columns:e.rightFixedColumns,columnSettings:e.columnSettings}})],1)])},V=[],M=function(){var e=this,t=e._self._c;return t("svg",{staticClass:"icon",attrs:{t:"1768525838046",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"10889","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1em",height:"1em",fill:"currentColor"}},[t("path",{attrs:{d:"M924.8 625.7l-65.5-56c3.1-19 4.7-38.4 4.7-57.8s-1.6-38.8-4.7-57.8l65.5-56c10.1-8.6 13.8-22.6 9.3-35.2l-0.9-2.6c-18.1-50.5-44.9-96.9-79.7-137.9l-1.8-2.1c-8.6-10.1-22.5-13.9-35.1-9.5l-81.3 28.9c-30-24.6-63.5-44-99.7-57.6l-15.7-85c-2.4-13.1-12.7-23.3-25.8-25.7l-2.7-0.5c-52.1-9.4-106.9-9.4-159 0l-2.7 0.5c-13.1 2.4-23.4 12.6-25.8 25.7l-15.8 85.4c-35.9 13.6-69.2 32.9-99 57.4l-81.9-29.1c-12.5-4.4-26.5-0.7-35.1 9.5l-1.8 2.1c-34.8 41.1-61.6 87.5-79.7 137.9l-0.9 2.6c-4.5 12.5-0.8 26.5 9.3 35.2l66.3 56.6c-3.1 18.8-4.6 38-4.6 57.1 0 19.2 1.5 38.4 4.6 57.1L99 625.5c-10.1 8.6-13.8 22.6-9.3 35.2l0.9 2.6c18.1 50.4 44.9 96.9 79.7 137.9l1.8 2.1c8.6 10.1 22.5 13.9 35.1 9.5l81.9-29.1c29.8 24.5 63.1 43.9 99 57.4l15.8 85.4c2.4 13.1 12.7 23.3 25.8 25.7l2.7 0.5c26.1 4.7 52.8 7.1 79.5 7.1 26.7 0 53.5-2.4 79.5-7.1l2.7-0.5c13.1-2.4 23.4-12.6 25.8-25.7l15.7-85c36.2-13.6 69.7-32.9 99.7-57.6l81.3 28.9c12.5 4.4 26.5 0.7 35.1-9.5l1.8-2.1c34.8-41.1 61.6-87.5 79.7-137.9l0.9-2.6c4.5-12.3 0.8-26.3-9.3-35zM788.3 465.9c2.5 15.1 3.8 30.6 3.8 46.1s-1.3 31-3.8 46.1l-6.6 40.1 74.7 63.9c-11.3 26.1-25.6 50.7-42.6 73.6L721 702.8l-31.4 25.8c-23.9 19.6-50.5 35-79.3 45.8l-38.1 14.3-17.9 97c-28.1 3.2-56.8 3.2-85 0l-17.9-97.2-37.8-14.5c-28.5-10.8-55-26.2-78.7-45.7l-31.4-25.9-93.4 33.2c-17-22.9-31.2-47.6-42.6-73.6l75.5-64.5-6.5-40c-2.4-14.9-3.7-30.3-3.7-45.5 0-15.3 1.2-30.6 3.7-45.5l6.5-40-75.5-64.5c11.3-26.1 25.6-50.7 42.6-73.6l93.4 33.2 31.4-25.9c23.7-19.5 50.2-34.9 78.7-45.7l37.9-14.3 17.9-97.2c28.1-3.2 56.8-3.2 85 0l17.9 97 38.1 14.3c28.7 10.8 55.4 26.2 79.3 45.8l31.4 25.8 92.8-32.9c17 22.9 31.2 47.6 42.6 73.6L781.8 426l6.5 39.9z","p-id":"10890"}}),t("path",{attrs:{d:"M512 326c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176z m79.2 255.2C570 602.3 541.9 614 512 614c-29.9 0-58-11.7-79.2-32.8C411.7 560 400 531.9 400 502c0-29.9 11.7-58 32.8-79.2C454 401.6 482.1 390 512 390c29.9 0 58 11.6 79.2 32.8C612.3 444 624 472.1 624 502c0 29.9-11.7 58-32.8 79.2z","p-id":"10891"}})])},$=[],N={name:"SettingIcon"},B=N,H=w(B,M,$,!1,null,"5f121054",null),U=H.exports,q=function(){var e=this,t=e._self._c;return e.columns.length?t("div",{staticClass:"column-settings-item-list"},[t("div",{staticClass:"title"},[e._v(e._s(e.title))]),t("div",{ref:"dragDropZoneRef",staticClass:"drag-drop-zone"},e._l(e.columns,function(n,o){return t("div",{key:n.prop,staticClass:"column-settings-item",class:{draggable:e.draggable,dragging:e.dragIndex===o},attrs:{draggable:e.draggable},on:{dragstart:t=>e.onDragstart(t,o),dragenter:function(t){return t.preventDefault(),e.onDragenter.apply(null,arguments)},dragover:function(t){return t.preventDefault(),(t=>e.onDragover(t,o)).apply(null,arguments)},dragleave:e.onDragleave,drop:t=>e.onDrop(t,o),dragend:e.onDragend}},[e.draggable?t("span",{staticClass:"icon icon-holder"},[t("HolderIcon")],1):e._e(),t("span",{staticClass:"switcher"}),t(e.dynamicComponent,e._g(e._b({tag:"component"},"component","el-checkbox"===e.dynamicComponent?{value:n.checkable,disabled:n.disabled}:{class:"toggleable-checkbox"},!1),"el-checkbox"===e.dynamicComponent?{change:t=>e.handleChange(t,n.prop)}:{}),[t("span",{staticClass:"label"},[e._v(e._s(n.label))]),t("ColumnAlignSettings",{attrs:{column:n}}),0===o&&e.dropIndex===o?t("div",{staticClass:"indicator head-indicator"}):e.dropIndex===o+1?t("div",{staticClass:"indicator tail-indicator"}):e._e()],1)],1)}),0)]):e._e()},K=[],W=function(){var e=this,t=e._self._c;return t("svg",{staticClass:"icon",attrs:{t:"1768466031154",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4754","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1em",height:"1em",fill:"currentColor"}},[t("path",{attrs:{d:"M300 276.497a56 56 0 1 0 56-96.994 56 56 0 0 0-56 96.994z m0 284a56 56 0 1 0 56-96.994 56 56 0 0 0-56 96.994zM640 228a56 56 0 1 0 112 0 56 56 0 0 0-112 0z m0 284a56 56 0 1 0 112 0 56 56 0 0 0-112 0zM300 844.497a56 56 0 1 0 56-96.994 56 56 0 0 0-56 96.994zM640 796a56 56 0 1 0 112 0 56 56 0 0 0-112 0z","p-id":"4755"}})])},X=[],Z={name:"HolderIcon"},Y=Z,G=w(Y,W,X,!1,null,"4567deaf",null),J=G.exports,Q=function(){var e=this,t=e._self._c;return t("span",{staticClass:"icon-algin-group"},["left"!==e.column.fixed?[t("el-tooltip",{attrs:{content:"固定在列首",placement:"top"}},[t("VerticalAlignTopIcon",{nativeOn:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleAlgin("left")}}})],1)]:e._e(),"left"===e.column.fixed||"right"===e.column.fixed?[t("el-tooltip",{attrs:{content:"不固定",placement:"top"}},[t("VerticalAlginMiddleIcon",{nativeOn:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleAlgin()}}})],1)]:e._e(),"right"!==e.column.fixed?[t("el-tooltip",{attrs:{content:"固定在列尾",placement:"top"}},[t("VerticalAlginBottomIcon",{nativeOn:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleAlgin("right")}}})],1)]:e._e()],2)},ee=[],te=function(){var e=this,t=e._self._c;return t("svg",{staticClass:"icon",attrs:{t:"1768466090113",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5827","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1em",height:"1em"}},[t("path",{attrs:{d:"M955.968 100.864v66.944h-864V100.864h864zM528.064 215.616l150.784 150.784H565.76V928H490.24l0.128-561.6H377.216L528 215.68z",fill:"currentColor","p-id":"5828"}})])},ne=[],oe={name:"VerticalAlignTopIcon"},le=oe,re=w(le,te,ne,!1,null,"157c15ff",null),se=re.exports,ie=function(){var e=this,t=e._self._c;return t("svg",{staticClass:"icon",attrs:{t:"1768466105119",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6880","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1em",height:"1em"}},[t("path",{attrs:{d:"M955.968 928v-66.944h-864V928h864z m-427.904-114.752l150.784-150.784H565.76V100.864H490.24l0.128 561.6H377.216l150.848 150.784z",fill:"currentColor","p-id":"6881"}})])},ae=[],ce={name:"VerticalAlignBottomIcon"},ue=ce,pe=w(ue,ie,ae,!1,null,"5f3f60a5",null),de=pe.exports,me=function(){var e=this,t=e._self._c;return t("svg",{staticClass:"icon",attrs:{t:"1768466311335",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"9722","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1em",height:"1em",fill:"currentColor"}},[t("path",{attrs:{d:"M512 614.4l-153.6 153.6 102.4 0 0 204.8 102.4 0 0-204.8 102.4 0L512 614.4zM665.6 256l-102.4 0L563.2 51.2 460.8 51.2l0 204.8L358.4 256l153.6 153.6L665.6 256zM921.6 512c0-28.3136-2.4576-51.2-30.72-51.2L133.12 460.8C104.8576 460.8 102.4 483.6864 102.4 512c0 28.2112 2.4576 51.2 30.72 51.2L890.88 563.2C919.1424 563.2 921.6 540.2112 921.6 512z","p-id":"9723"}})])},he=[],ge={name:"VerticalAlignMiddleIcon"},fe=ge,be=w(fe,me,he,!1,null,"5047af18",null),Ce=be.exports,xe={name:"ColumnAlginSettings",inject:["onColumnSettingsChange"],components:{VerticalAlignTopIcon:se,VerticalAlginMiddleIcon:Ce,VerticalAlginBottomIcon:de},props:{column:{type:Object,default:()=>({})}},methods:{handleAlgin(e){const{prop:t}=this.column;this.onColumnSettingsChange({event:"align",prop:t,fixed:e})}}},ve=xe,ye=w(ve,Q,ee,!1,null,"25fd06be",null),Se=ye.exports,_e={name:"ColumnSettingsItem",components:{HolderIcon:J,ColumnAlignSettings:Se},inject:["onColumnSettingsChange"],props:{columns:{type:Array,required:!0,default:()=>[]},columnSettings:{type:Object}},computed:{title(){const{columns:e}=this;if(Array.isArray(e)&&e.length){const t=e[0].fixed;return"left"===t?"固定在左侧":"right"===t?"固定在右侧":"不固定"}return""},draggable(){return this.columnSettings.draggable&&this.columns?.length>1},dynamicComponent(){return this.columnSettings.checkable?"el-checkbox":"span"}},data(){return{dragIndex:-1,dropIndex:-1}},methods:{handleChange(e,t){this.onColumnSettingsChange({event:"check",checked:e,prop:t})},getCursorPos(e){const t=e.target.getBoundingClientRect(),n=e.clientY-t.top,o=n<t.height/2?"top":"bottom";return o},getDropIndex(e,t){const n=this.getCursorPos(e),o="top"===n?t:t+1,l=this.dragIndex<t?"down":"up";if(o===this.dragIndex)return-1;const r=1===Math.abs(o-this.dragIndex);return r&&"down"===l?-1:o},onDragstart(e,t){e.dataTransfer.effectAllowed="move",e.dataTransfer.dropEffect="move",this.dragIndex=t},onDragenter(e){-1===this.dragIndex?e.dataTransfer.dropEffect="none":e.dataTransfer.dropEffect="move"},onDragover(e,t){this.dragIndex<0?e.dataTransfer.dropEffect="none":this.dragIndex!==t?this.dropIndex=this.getDropIndex(e,t):this.dropIndex=-1},onDragleave(e){const t=this.$refs.dragDropZoneRef;t.contains(e.relatedTarget)||(this.dropIndex=-1)},onDrop(e,t){if(this.dragIndex===t)return void(this.dropIndex=-1);const n=this.getDropIndex(e,t);if(n>-1){const{columns:e}=this,t=e[this.dragIndex].prop,o=n===this.columns.length,l=o?e[n-1].prop:e[n].prop;this.onColumnSettingsChange({event:"drop",fromProp:t,toProp:l,isAfter:o})}},onDragend(){this.dragIndex=-1,this.dropIndex=-1}}},we=_e,Ie=w(we,q,K,!1,null,"bb9b3504",null),ke=Ie.exports,Pe={name:"ColumnSettings",components:{SettingIcon:U,ColumnSettingsItem:ke},inject:["onColumnSettingsChange"],props:{columns:{type:Array,required:!0},columnSettings:{type:Object}},computed:{leftFixedColumns(){return this.columns.filter(e=>"left"===e.fixed)},noFixedColumns(){return this.columns.filter(e=>"left"!==e.fixed&&"right"!==e.fixed)},rightFixedColumns(){return this.columns.filter(e=>"right"===e.fixed)},checkAll(){return this.columns.length===this.columns.filter(e=>e.checkable).length},isIndeterminate(){return!this.checkAll&&this.columns.filter(e=>!e.disabled&&e.checkable).length>0}},data(){return{}},methods:{handleChange(e){this.onColumnSettingsChange({event:"checkAll",checked:e})},handleReset(){this.onColumnSettingsChange({event:"reset"})}}},ze=Pe,Re=w(ze,F,V,!1,null,"7e72f8a5",null),Te=Re.exports,Ee={name:"ProTable",components:{ProFormItem:T,CustomRender:k,ArrowIcon:D,ColumnSettings:Te},provide(){if(this.columnSettings)return{onColumnSettingsChange:this.onColumnSettingsChange}},props:{search:{type:[Boolean,Object],default:!0},className:{type:String},dataSource:{type:Array},loading:{type:Boolean},total:{type:Number,default:0},tableProps:{type:Object,default:()=>({})},tableEvents:{type:Object,default:()=>({})},columns:{type:Array,required:!0,default:()=>[]},paginationProps:{type:Object,default:()=>({})},paginationMapping:{type:Object,default:()=>({})},initialValues:{type:Object,default:()=>({})},defaultSize:{type:String,validator:function(e){return["medium","small","mini"].includes(e)}},manualRequest:{type:Boolean,default:!1},columnSettings:{type:[Boolean,Object],default:!0}},computed:{searchProps(){const{search:e}=this;if(e){const t={searchText:"查询",resetText:"重置",labelWidth:"80px",rowProps:{gutter:8},colProps:d,collapsed:!0,defaultExpandedRows:2};return"object"===typeof e?{...t,...this.search,collapsed:e.collapsed??e.defaultCollapsed??t.collapsed}:{...t}}return!1},formItems(){const{columns:e}=this;return e.filter(e=>!e.hideInSearch&&(!!e.valueType||e.renderField)).sort((e,t)=>t.order-e.order).map(e=>{const{label:t,prop:n,formItemProps:o={},renderLabel:l,valueType:r,renderField:s,fieldProps:u={},fieldEvents:p,initialValue:d}=e;return o.label=o.label||t,o.prop=o.prop||n,i(u,r),a(e,this.cachedOptions),c(u,e,this.cachedOptions),{...o,renderLabel:l,valueType:r,renderField:s,fieldProps:u,fieldEvents:p,options:e.options,initialValue:d}})},totalSearchCount(){return this.formItems.length},normalizedColumns(){const{columns:e,initializedColumnSettings:t,columnSettingsRule:n}=this;let o=e.filter(e=>!e.hideInTable).map(e=>{const{formItemProps:t,renderLabel:n,valueType:o,renderField:l,fieldProps:r,fieldEvents:s,options:i,valueEnum:a,optionLoader:c,initialValue:u,order:p,hideInSearch:d,renderCellHeader:m,renderCell:h,disabled:g,key:f,...b}=e;return{...b,nonElColumnProps:{valueEnum:a,renderCellHeader:m,renderCell:h,key:f,disabled:g}}});t&&n?.length&&(o=o.map(e=>{const t=n.find(t=>(e.prop||e.nonElColumnProps.key)===t.prop);if(t){const{checkable:n,fixed:o,index:l}=t;return e.nonElColumnProps={...e.nonElColumnProps,checkable:n,index:l},{...e,fixed:o}}return e}));const{draggable:l,checkable:r}=t;return l&&o.sort((e,t)=>e.nonElColumnProps.index-t.nonElColumnProps.index),r&&(o=o.filter(e=>e.nonElColumnProps.checkable)),o},settingColumns(){const{columnSettings:e}=this;if(!e)return[];const{columnSettingsRule:t,columns:n}=this;return t.map(e=>{const t=n.find(t=>e.prop===(t.prop||t.key));if(t){const{label:n,disabled:o}=t;return{...e,label:n,disabled:o}}return e})},initializedColumnSettings(){const{columnSettings:e}=this;if(e){const t={resetText:"重置",settingText:"列设置",draggable:!0,checkable:!0};return"object"===typeof e?{...t,...e}:t}return!1},initializedTableProps(){const{tableProps:e,defaultSize:t}=this;return{size:t,...e}},initializedTableEvents(){return{"sort-change":this.sortChange,...this.tableEvents}},initializedPaginationProps(){return{"page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper","hide-on-single-page":!0,...this.paginationProps,"current-page":this.pageNum,"page-size":this.pageSize,total:this.total}}},data(){return{cachedOptions:{},form:this.initForm(),showExpandToggle:!1,searchColConfig:d,collapsed:!0,searchCount:0,tableKey:1,pageNum:1,pageSize:this.paginationProps["page-size"]||10,columnSettingsRule:[]}},watch:{totalSearchCount(){this.calculateSearchLayout()},"search.collapsed":function(e){e!==this.collapsed&&this.handleCollapse()}},created(){this.getOptions(),this.manualRequest||this.handleSearch(),this.columnSettings&&(this.columnSettingsRule=this.initializeColumnSettingsRule())},mounted(){const e=this.isResponsive();this.calculateSearchLayout(e),e&&(this.debounceResize=f(this.resize),window.addEventListener("resize",this.debounceResize))},methods:{getOptions(){const{columns:e}=this;for(const t of e){const{prop:e,fieldProps:n={},optionLoader:o}=t;o&&"function"===typeof o&&o().then(t=>{const o=n.prop||e;this.cachedOptions={...this.cachedOptions,[o]:t}})}},initForm(){const{columns:e}=this;if(!e.length)return{};const t=e.filter(e=>!!e.valueType).reduce((e,t)=>{const{prop:n,fieldProps:o={},initialValue:l}=t,r=o.prop||n;return r?{...e,[r]:l}:e},{});return{...this.initialValues,...t}},isResponsive(){const{searchProps:{colProps:e}}=this,t=Object.keys(e);return t.some(e=>m.includes(e))},calculateSearchLayout(e=!1){const{searchProps:{colProps:t,defaultExpandedRows:n},totalSearchCount:o}=this;this.cachedSpanPerField=e?g(t):t.span||8,this.maxVisibleFields=Math.floor(p/this.cachedSpanPerField*n)-1,this.showExpandToggle=o>this.maxVisibleFields,this.showExpandToggle&&(this.collapsed=this.searchProps.collapsed),this.updateSearchLayout()},updateSearchLayout(){const{searchProps:{colProps:e},cachedSpanPerField:t}=this;this.searchCount=this.showExpandToggle&&this.collapsed?this.maxVisibleFields:this.totalSearchCount;const n=p-t*this.searchCount%p,o=n-t;this.searchColConfig={...e,offset:o}},resize(){this.calculateSearchLayout(!0)},handleCollapse(){this.collapsed=!this.collapsed,this.$emit("onCollapse",this.collapsed),this.showExpandToggle&&this.updateSearchLayout()},getParams(){const{pageNum:e,pageSize:t,paginationMapping:{pageKey:n,sizeKey:o}}=this;return{...this.form,[n||"pageNum"]:e,[o||"pageSize"]:t}},handleReset(){this.form=this.initForm(),this.pageNum=1,this.$emit("onParams",this.getParams()),this.$emit("onReset")},handleSearch(){this.pageNum=1;const e=this.getParams();this.$emit("onParams",e),this.$emit("onSubmit",e)},reload(e=!0){e&&(this.pageNum=1),this.$emit("onParams",this.getParams())},sortChange({prop:e,order:t}){this.pageNum=1,this.$emit("onParams",{...this.getParams(),prop:e,order:t})},handleCurrentChange(e){this.pageNum=e,this.$emit("onParams",this.getParams())},handleSizeChange(e){this.pageSize=e,this.pageNum=1,this.$emit("onParams",this.getParams())},getTableRef(){return this.$refs.tableRef},initializeColumnSettingsRule(){return this.columns.filter(e=>!e.hideInTable&&(e.prop||e.key)).map((e,t)=>{const{prop:n,key:o,fixed:l}=e;return{prop:n||o,fixed:l,checkable:!0,index:t}})},getUID(){return b()},checkAllRule(e){this.columnSettingsRule=this.columnSettingsRule.map(t=>{const n=this.columns.find(e=>(e.prop||e.key)===t.prop);return n?{...t,checkable:n.disabled?t.checkable:e}:t})},checkRule(e,t){const{columnSettingsRule:n}=this,o=n.findIndex(t=>t.prop===e);-1!==o&&n.splice(o,1,{...n[o],checkable:t})},handleAlignRule(e,t){const{columnSettingsRule:n}=this,o=n.findIndex(t=>t.prop===e);if(-1!==o){const e=n[o];n.splice(o,1,{...e,fixed:t})}},handleResetRule(){this.columnSettingsRule=this.initializeColumnSettingsRule()},handleDropRule(e,t,n=!1){const{columnSettingsRule:o}=this,l=o.findIndex(t=>(t.prop||t.key)===e);if(-1===l)return;const r=o.findIndex(e=>(e.prop||e.key)===t);if(-1===r)return;const s=l>r,i=s?r:l+1,a=s?l:n?r+1:r;for(let u=i;u<a;++u){const e=o[u];o.splice(u,1,{...e,index:s?e.index+1:e.index-1})}const c=o[l];s?(o.splice(l,1),o.splice(r,0,{...c,index:r})):(o.splice(r,0,{...c,index:r}),o.splice(l,1))},doLayout(){this.$nextTick(()=>{this.$refs.tableRef?.doLayout()})},onColumnSettingsChange(e){const{event:t,prop:n,checked:o,fixed:l,fromProp:r,toProp:s,isAfter:i}=e;switch(t){case"checkAll":this.checkAllRule(o),this.doLayout();break;case"check":this.checkRule(n,o),this.doLayout();break;case"align":this.handleAlignRule(n,l);break;case"reset":this.handleResetRule(),this.tableKey=this.getUID();break;case"drop":this.handleDropRule(r,s,i),this.tableKey=this.getUID();break;default:break}}},beforeDestroy(){window.removeEventListener("resize",this.resize),this.debounceResize?.cancel()}},Ae=Ee,Le=w(Ae,l,r,!1,null,"5d0503a8",null),Oe=Le.exports;Oe.install=function(e){e.component(Oe.name,Oe)};var je=Oe,De=je;return t}()});
//# sourceMappingURL=index.umd.min.js.map