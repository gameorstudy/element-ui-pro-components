(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("el-table-prepend")):"function"===typeof define&&define.amd?define(["el-table-prepend"],t):"object"===typeof exports?exports["index"]=t(require("el-table-prepend")):e["index"]=t(e["el-table-prepend"])})("undefined"!==typeof self?self:this,function(e){return function(){"use strict";var t={253:function(e){function t(){return t=Object.assign?Object.assign.bind():function(e){for(var t,r=1;r<arguments.length;r++)for(var o in t=arguments[r],t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},t.apply(this,arguments)}var r=["attrs","props","domProps"],o=["class","style","directives"],n=["on","nativeOn"],i=function(e){return e.reduce(function(e,i){for(var l in i)if(e[l])if(-1!==r.indexOf(l))e[l]=t({},e[l],i[l]);else if(-1!==o.indexOf(l)){var a=e[l]instanceof Array?e[l]:[e[l]],c=i[l]instanceof Array?i[l]:[i[l]];e[l]=[].concat(a,c)}else if(-1!==n.indexOf(l))for(var d in i[l])if(e[l][d]){var u=e[l][d]instanceof Array?e[l][d]:[e[l][d]],p=i[l][d]instanceof Array?i[l][d]:[i[l][d]];e[l][d]=[].concat(u,p)}else e[l][d]=i[l][d];else if("hook"===l)for(var m in i[l])e[l][m]=e[l][m]?s(e[l][m],i[l][m]):i[l][m];else e[l]=i[l];else e[l]=i[l];return e},{})},s=function(e,t){return function(){e&&e.apply(this,arguments),t&&t.apply(this,arguments)}};e.exports=i},309:function(t){t.exports=e}},r={};function o(e){var n=r[e];if(void 0!==n)return n.exports;var i=r[e]={exports:{}};return t[e](i,i.exports,o),i.exports}!function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.p=""}();var n={};if(o.r(n),o.d(n,{DialogForm:function(){return G},EditableProTable:function(){return Ut},ProForm:function(){return B},ProTable:function(){return ft},default:function(){return Xt}}),"undefined"!==typeof window){var i=window.document.currentScript,s=i&&i.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);s&&(o.p=s[1])}var l,a,c=function(){var e=this,t=e._self._c;return t("el-form",e._b({ref:"proFormRef",staticClass:"pro-form",class:e.className,attrs:{model:e.form}},"el-form",e.formProps,!1),[e.grid?[t("el-row",e._b({},"el-row",e.rowProps,!1),e._l(e.normalizedFormItems,function(r){return t("el-col",e._b({key:r.prop??e.getUID()},"el-col",r.colProps,!1),[r.customSlot?e._t(!0===r.customSlot?r.prop:r.customSlot,null,null,{form:e.form}):r.renderFormItem?t("CustomRender",{attrs:{render:()=>r.renderFormItem(e.form)}}):t("ProFormItem",{attrs:{form:e.form,formItem:r},scopedSlots:e._u([{key:r.prop,fn:function(){return[e._t(r.prop,null,null,{form:e.form,formItem:r})]},proxy:!0}],null,!0)})],2)}),1)]:[e._l(e.normalizedFormItems,function(r){return[r.customSlot?e._t(!0===r.customSlot?r.prop:r.customSlot,null,null,{form:e.form}):r.renderFormItem?t("CustomRender",{attrs:{render:()=>r.renderFormItem(e.form)}}):t("ProFormItem",{key:r.prop??e.getUID(),attrs:{form:e.form,formItem:r},scopedSlots:e._u([{key:r.prop,fn:function(){return[e._t(r.prop,null,null,{form:e.form,formItem:r})]},proxy:!0}],null,!0)})]})],e.submitter?[e.submitter.customRender?[t("Submitter",{attrs:{submitter:e.submitterProps,action:{submit:e.submit,reset:e.reset,resetAllFields:e.resetAllFields},render:(t,r)=>e.submitter.customRender(e.form,t,r)}})]:[t("el-form-item",{staticClass:"pro-table-submitter"},[t("el-button",e._b({on:{click:e.reset}},"el-button",e.submitterProps.resetButtonProps,!1),[e._v(e._s(e.submitterProps.resetText))]),t("el-button",e._b({attrs:{type:"primary"},on:{click:e.submit}},"el-button",e.submitterProps.submitButtonProps,!1),[e._v(e._s(e.submitterProps.submitText))])],1)]]:e._e()],2)},d=[],u={name:"CustomRender",props:{render:{type:Function,required:!0}},render:function(e){return e("Fragment",[this.render()])}},p=u;function m(e,t,r,o,n,i,s,l){var a,c="function"===typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=r,c._compiled=!0),o&&(c.functional=!0),i&&(c._scopeId="data-v-"+i),s?(a=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},c._ssrRegister=a):n&&(a=l?function(){n.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:n),a)if(c.functional){c._injectStyles=a;var d=c.render;c.render=function(e,t){return a.call(t),d(e,t)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,a):[a]}return{exports:e,options:c}}var f,h,g=m(p,l,a,!1,null,"2ddfacb0",null),b=g.exports,y=function(){var e=this,t=e._self._c;return t("el-form-item",e._b({scopedSlots:e._u([e.formItem.renderLabel?{key:"label",fn:function(){return[t("CustomRender",{attrs:{render:e.formItem.renderLabel}})]},proxy:!0}:null],null,!0)},"el-form-item",e.normalizedFormItem,!1),[e.formItem.renderField?t("CustomRender",{attrs:{render:()=>e.formItem.renderField({form:e.form,formItem:e.formItem})}}):"slot"===e.formItem.valueType?e._t(e.formItem.prop):t(`el-${e.formItem.valueType}`,e._g(e._b({tag:"component",model:{value:e.form[e.formItem.prop],callback:function(t){e.$set(e.form,e.formItem.prop,t)},expression:"form[formItem.prop]"}},"component",e.formItem.fieldProps,!1),e.formItem.fieldEvents),["select"===e.formItem.valueType?[e.formItem.options?.[0]?.options?e._l(e.formItem.options,function(r){return t("el-option-group",e._b({key:r.label},"el-option-group",r,!1),e._l(r.options,function(r){return t("el-option",e._b({key:r.value},"el-option",r,!1))}),1)}):e._l(e.formItem.options,function(r){return t("el-option",e._b({key:r.value},"el-option",r,!1))})]:e.groups.includes(e.formItem.valueType)?e._l(e.formItem.options,function(r){return t(e.selection[e.formItem.valueType],{key:r.value,tag:"component",attrs:{label:r.value}},[e._v(" "+e._s(r.label)+" ")])}):e._e()],2)],2)},v=[],x={name:"ProFormItem",components:{CustomRender:b},props:{formItem:{type:Object,required:!0},form:{type:Object,required:!0}},computed:{normalizedFormItem(){const{renderLabel:e,valueType:t,renderField:r,fieldProps:o,fieldEvents:n,options:i,valueEnum:s,optionLoader:l,initialValue:a,colProps:c,...d}=this.formItem;return d}},data(){return{groups:["radio-group","checkbox-group"],selection:{"radio-group":"el-radio","checkbox-group":"el-checkbox"}}}},C=x,w=m(C,y,v,!1,null,"19729659",null),_=w.exports,P=o(253),I=o.n(P),S={name:"Submitter",props:{render:{type:Function,required:!0},submitter:{type:Object,required:!0},action:{type:Object,required:!0}},render:function(e){const{submitter:{resetText:t,submitText:r,resetButtonProps:o,submitButtonProps:n},action:{reset:i,submit:s}}=this,l={props:o,resetButtonProps:o},a={props:n,submitButtonProps:n},c=[e("el-button",I()([{},l,{on:{click:i},key:"reset"}]),[t]),e("el-button",I()([{attrs:{type:"primary"}},a,{on:{click:s},key:"submit"}]),[r])];return e("Fragment",[this.render(this.action,c)])}},R=S,k=m(R,f,h,!1,null,"ee280a3c",null),E=k.exports;function z(){if("undefined"!==typeof crypto&&crypto.randomUUID)return crypto.randomUUID();const e=new Uint8Array(16);return crypto.getRandomValues(e),Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}function F(e){switch(e){case"input":case"input-number":return"请输入";case"select":case"time-picker":case"date-picker":case"cascader":return"请选择";default:return""}}function T(e,t){e.placeholder=e.placeholder??F(t)}function O(e,t){const{valueType:r,prop:o,options:n,valueEnum:i,optionLoader:s}=e;"select"===r&&(n?.length>0||(i?i instanceof Map?e.options=Array.from(i,([e,t])=>({label:t,value:e})):e.options=Object.entries(i).map(([e,t])=>({label:t,value:e})):e.options=s&&t[o]?t[o]:[]))}function L(e,t,r){const{valueType:o,prop:n,optionLoader:i}=t;"cascader"===o&&(e.options?.length>0||i&&r[n]&&(e.options=r[n]))}var j={name:"ProForm",components:{CustomRender:b,ProFormItem:_,Submitter:E},props:{formProps:{type:Object,default:()=>({})},className:{type:String},formItems:{type:Array,required:!0,default:()=>[]},submitter:{type:[Boolean,Object],default:!0},grid:{type:Boolean},rowProps:{type:Object,default:()=>({gutter:8})},initialValues:{type:Object,default:()=>({})}},computed:{normalizedFormItems(){return this.formItems.filter(e=>!e.hideInForm).map(e=>{const{valueType:t,fieldProps:r={}}=e;return T(r,t),O(e,this.cachedOptions),L(r,e,this.cachedOptions),{...e,fieldProps:r}})},submitterProps(){if(this.submitter){const e={resetText:"重置",submitText:"提交"};return"object"===typeof this.submitter?{...e,...this.submitter}:{...e}}return!1}},data(){return{cachedOptions:{},form:this.initForm()}},created(){this.getOptions()},methods:{getOptions(){for(const e of this.formItems){const{prop:t,optionLoader:r}=e;"function"===typeof r&&r().then(e=>{this.cachedOptions={...this.cachedOptions,[t]:e}})}},initForm(){const{formItems:e,initialValues:t}=this,r=e.reduce((e,t)=>{const{prop:r,initialValue:o}=t;return r?{...e,[r]:o}:e},{});return{...t,...r}},getFormRef(){return this.$refs.proFormRef},getForm(){return this.form},setFieldsValue(e){this.form={...this.form,...e}},setFieldValue(e,t){this.form[e]=t},submit(){this.$refs.proFormRef?.validate((e,t)=>{e?this.$emit("onFinish",this.form):this.$emit("onError",t)})},async reset(){try{await(this.$refs.proFormRef?.resetFields()),this.$emit("onReset")}catch(e){console.error("err",e)}},resetAllFields(){this.$refs.proFormRef?.clearValidate(),this.form=this.initForm()},getUID(){return z()}}},$=j,A=m($,c,d,!1,null,"225d76ea",null),K=A.exports;K.install=function(e){e.component(K.name,K)};var D,V,B=K,M=function(){var e=this,t=e._self._c;return t("el-dialog",e._g(e._b({attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}},scopedSlots:e._u([e.renderTitle?{key:"title",fn:function(){return[t("CustomRender",{attrs:{render:()=>e.renderTitle(e.form)}})]},proxy:!0}:null,e.submitter?{key:"footer",fn:function(){return[e.submitter.customRender?[t("Submitter",{attrs:{submitter:e.submitterProps,action:{submit:e.submit,close:e.close,reset:e.reset,resetAllFields:e.resetAllFields},render:(t,r)=>e.submitter.customRender(e.form,t,r)}})]:[t("span",{staticClass:"dialog-form-footer"},[t("el-button",e._b({on:{click:e.close}},"el-button",e.submitterProps.cancelButtonProps,!1),[e._v(e._s(e.submitterProps.cancelText))]),t("el-button",e._b({attrs:{type:"primary"},on:{click:e.submit}},"el-button",e.submitterProps.submitButtonProps,!1),[e._v(e._s(e.submitterProps.submitText))])],1)]]},proxy:!0}:null],null,!0)},"el-dialog",e.normalizedDialogProps,!1),e.normalizedDialogEvents),[t("el-form",e._b({ref:"dialogFormRef",staticClass:"pro-form",class:e.className,attrs:{model:e.form}},"el-form",e.formProps,!1),[e.grid?[t("el-row",e._b({},"el-row",e.rowProps,!1),e._l(e.normalizedFormItems,function(r){return t("el-col",e._b({key:r.prop??e.getUID()},"el-col",r.colProps,!1),[r.customSlot?e._t(!0===r.customSlot?r.prop:r.customSlot,null,null,{form:e.form}):r.renderFormItem?t("CustomRender",{attrs:{render:()=>r.renderFormItem(e.form)}}):t("ProFormItem",{attrs:{form:e.form,formItem:r},scopedSlots:e._u([{key:r.prop,fn:function(){return[e._t(r.prop,null,null,{form:e.form,formItem:r})]},proxy:!0}],null,!0)})],2)}),1)]:[e._l(e.normalizedFormItems,function(r){return[r.customSlot?e._t(!0===r.customSlot?r.prop:r.customSlot,null,null,{form:e.form}):r.renderFormItem?t("CustomRender",{attrs:{render:()=>r.renderFormItem(e.form)}}):t("ProFormItem",{key:r.prop??e.getUID(),attrs:{form:e.form,formItem:r},scopedSlots:e._u([{key:r.prop,fn:function(){return[e._t(r.prop,null,null,{form:e.form,formItem:r})]},proxy:!0}],null,!0)})]})]],2)],1)},N=[],q={name:"Submitter",props:{render:{type:Function,required:!0},submitter:{type:Object,required:!0},action:{type:Object,required:!0}},render:function(e){const{submitter:{cancelText:t,submitText:r,cancelButtonProps:o,submitButtonProps:n},action:{close:i,submit:s}}=this,l={props:o,cancelButtonProps:o},a={props:n,submitButtonProps:n},c=[e("el-button",I()([{},l,{on:{click:i},key:"close"}]),[t]),e("el-button",I()([{attrs:{type:"primary"}},a,{on:{click:s},key:"submit"}]),[r])];return e("Fragment",[this.render(this.action,c)])}},U=q,H=m(U,D,V,!1,null,"6996c191",null),W=H.exports,J={name:"DialogForm",model:{prop:"visible",event:"close"},components:{CustomRender:b,ProFormItem:_,Submitter:W},props:{visible:{type:Boolean,default:!1},title:{type:String},renderTitle:{type:Function},width:{type:String},dialogProps:{type:Object,default:()=>({})},dialogEvents:{type:Object,default:()=>({})},formProps:{type:Object,default:()=>({})},className:{type:String},formItems:{type:Array,required:!0,default:()=>[]},submitter:{type:[Boolean,Object],default:!0},grid:{type:Boolean},rowProps:{type:Object,default:()=>({gutter:8})},initialValues:{type:Object,default:()=>({})}},computed:{normalizedDialogProps(){const{title:e,width:t,dialogProps:r={}}=this,o=r["custom-class"];return{...r,"custom-class":o?`${o} dialog-form`:"dialog-form",visible:void 0,title:e,width:t}},normalizedDialogEvents(){const{dialogEvents:e,close:t}=this,r=e.close;return r?(e.close=()=>{r(),t()},{...e}):{close:t}},normalizedFormItems(){return this.formItems.filter(e=>!e.hideInForm).map(e=>{const{valueType:t,fieldProps:r={}}=e;return T(r,t),O(e,this.cachedOptions),L(r,e,this.cachedOptions),{...e,fieldProps:r}})},submitterProps(){if(this.submitter){const e={cancelText:"取消",submitText:"确定"};return"object"===typeof this.submitter?{...e,...this.submitter}:{...e}}return!1}},data(){return{dialogVisible:!1,cachedOptions:{},form:this.initForm()}},watch:{visible:{handler(e){this.dialogVisible=e},immediate:!0}},created(){this.getOptions()},methods:{getOptions(){for(const e of this.formItems){const{prop:t,optionLoader:r}=e;"function"===typeof r&&r().then(e=>{this.cachedOptions={...this.cachedOptions,[t]:e}})}},initForm(){const{formItems:e,initialValues:t}=this,r=e.reduce((e,t)=>{const{prop:r,initialValue:o}=t;return r?{...e,[r]:o}:e},{});return{...t,...r}},getFormRef(){return this.$refs.dialogFormRef},getForm(){return this.form},setFieldsValue(e){this.form={...this.form,...e}},setFieldValue(e,t){this.form[e]=t},close(){this.$emit("close",!1)},submit(){this.$refs.dialogFormRef?.validate((e,t)=>{e?this.$emit("onFinish",this.form):this.$emit("onError",t)})},async reset(){try{await(this.$refs.dialogFormRef?.resetFields()),this.$emit("onReset")}catch(e){console.error("err",e)}},resetAllFields(){this.$refs.dialogFormRef?.clearValidate(),this.form=this.initForm()},getUID(){return z()}}},X=J,Z=m(X,M,N,!1,null,"7c2048c2",null),Y=Z.exports;Y.install=function(e){e.component(Y.name,Y)};var G=Y,Q=function(){var e=this,t=e._self._c;return t("div",{staticClass:"pro-table"},[e.search?[t("el-form",{staticClass:"pro-table__form",class:e.searchProps.className,attrs:{"label-width":e.searchProps.labelWidth,"label-position":e.searchProps.labelPosition,model:e.form,size:e.defaultSize}},[t("el-row",e._b({},"el-row",e.searchProps.rowProps,!1),[e._l(e.formItems,function(r,o){return t("el-col",e._b({key:r.prop??e.getUID(),style:{display:o>=e.searchCount?"none":""}},"el-col",e.searchProps.colProps,!1),[t("ProFormItem",{attrs:{form:e.form,formItem:r},scopedSlots:e._u([{key:r.prop,fn:function(){return[e._t(r.prop,null,null,{form:e.form,formItem:r})]},proxy:!0}],null,!0)})],1)}),t("el-col",e._b({key:"search",staticStyle:{display:"flex","align-items":"center","justify-content":"flex-end"}},"el-col",e.searchColConfig,!1),[t("el-button",{attrs:{icon:"el-icon-refresh",size:e.defaultSize},on:{click:e.handleReset}},[e._v(e._s(e.searchProps.resetText))]),t("el-button",{attrs:{type:"primary",icon:"el-icon-search",loading:e.loading,size:e.defaultSize},on:{click:e.handleSearch}},[e._v(e._s(e.searchProps.searchText))]),e.showExpandToggle?[t("el-button",{staticClass:"btn-collapse",attrs:{type:"text",size:e.defaultSize},on:{click:e.handleCollapse}},[e._v(" "+e._s(e.collapsed?"展开":"收起")+" "),t("ArrowIcon",{staticStyle:{transition:"0.3s"},style:{transform:`rotate(${e.collapsed?0:.5}turn)`}})],1)]:e._e()],2)],2)],1)]:e._e(),e.$slots.default||e.columnSettings?t("div",{staticClass:"pro-table__toolbar"},[e._t("default"),e.columnSettings?t("div",{staticClass:"pro-table__toolbar-items"},[t("ColumnSettings",{attrs:{columns:e.settingColumns,columnSettings:e.initializedColumnSettings}})],1):e._e()],2):e._e(),t("el-table",e._g(e._b({directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.tableKey,ref:"tableRef",staticClass:"pro-table__table",class:e.className,attrs:{data:e.dataSource}},"el-table",e.initializedTableProps,!1),e.initializedTableEvents),e._l(e.normalizedColumns,function(r){return t("el-table-column",e._b({key:r.prop||r.nonElColumnProps.key,scopedSlots:e._u([r.nonElColumnProps.renderCellHeader?{key:"header",fn:function(e){return[t("CustomRender",{attrs:{render:()=>r.nonElColumnProps.renderCellHeader(e)}})]}}:null,r.nonElColumnProps.renderCell?{key:"default",fn:function(e){return[t("CustomRender",{attrs:{render:()=>r.nonElColumnProps.renderCell(e)}})]}}:r.nonElColumnProps.valueEnum?{key:"default",fn:function(o){return[t("span",[e._v(" "+e._s(r.nonElColumnProps.valueEnum instanceof Map?r.nonElColumnProps.valueEnum.get(o.row?.[r.prop]):r.nonElColumnProps.valueEnum[o.row?.[r.prop]])+" ")])]}}:null],null,!0)},"el-table-column",{...r,nonElColumnProps:void 0},!1))}),1),t("el-pagination",e._b({staticClass:"pro-table__pagination",on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}},"el-pagination",e.initializedPaginationProps,!1))],2)},ee=[];const te={xs:0,sm:768,md:992,lg:1200,xl:1920},re=24,oe={xs:24,sm:24,md:12,lg:8,xl:6},ne=["xl","lg","md","sm","xs"],ie=e=>e>=te.xl?"xl":e>=te.lg?"lg":e>=te.md?"md":e>=te.sm?"sm":"xs",se=e=>{const t=ie(window.innerWidth),r=ne,o=r.indexOf(t);for(let n=o;n<r.length;n++){const t=r[n];if(e[t])return e[t]}return e.span||re},le=(e,t=150)=>{let r;const o=(...o)=>{r&&clearTimeout(r),r=setTimeout(()=>{e.apply(void 0,o)},t)};return o.cancel=function(){r&&(clearTimeout(r),r=null)},o};var ae=function(){var e=this,t=e._self._c;return t("svg",{attrs:{viewBox:"64 64 896 896",focusable:"false","data-icon":"down",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[t("path",{attrs:{d:"M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"}})])},ce=[],de={name:"ArrowIcon"},ue=de,pe=m(ue,ae,ce,!1,null,"03c6aa2a",null),me=pe.exports,fe=function(){var e=this,t=e._self._c;return t("el-popover",{attrs:{"popper-class":"column-settings-popover",placement:"bottom-end",trigger:"click"}},[t("div",{staticClass:"pro-table__toolbar-item",attrs:{slot:"reference"},slot:"reference"},[t("el-tooltip",{attrs:{content:e.columnSettings.settingText,placement:"top"}},[t("SettingIcon")],1)],1),t("div",{staticClass:"column-settings-popover-header"},[e.columnSettings.checkable?t("el-checkbox",{attrs:{value:e.checkAll,indeterminate:e.isIndeterminate},on:{change:e.handleChange}},[e._v(" "+e._s(e.columnSettings.settingText)+" ")]):t("span",[e._v(e._s(e.columnSettings.settingText))]),t("el-button",{attrs:{type:"text"},on:{click:e.handleReset}},[e._v(e._s(e.columnSettings.resetText))])],1),t("div",{staticClass:"column-settings-popover-content"},[t("ColumnSettingsItem",{attrs:{columns:e.leftFixedColumns,columnSettings:e.columnSettings}}),t("ColumnSettingsItem",{attrs:{columns:e.noFixedColumns,columnSettings:e.columnSettings}}),t("ColumnSettingsItem",{attrs:{columns:e.rightFixedColumns,columnSettings:e.columnSettings}})],1)])},he=[],ge=function(){var e=this,t=e._self._c;return t("svg",{staticClass:"icon",attrs:{t:"1768525838046",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"10889","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1em",height:"1em",fill:"currentColor"}},[t("path",{attrs:{d:"M924.8 625.7l-65.5-56c3.1-19 4.7-38.4 4.7-57.8s-1.6-38.8-4.7-57.8l65.5-56c10.1-8.6 13.8-22.6 9.3-35.2l-0.9-2.6c-18.1-50.5-44.9-96.9-79.7-137.9l-1.8-2.1c-8.6-10.1-22.5-13.9-35.1-9.5l-81.3 28.9c-30-24.6-63.5-44-99.7-57.6l-15.7-85c-2.4-13.1-12.7-23.3-25.8-25.7l-2.7-0.5c-52.1-9.4-106.9-9.4-159 0l-2.7 0.5c-13.1 2.4-23.4 12.6-25.8 25.7l-15.8 85.4c-35.9 13.6-69.2 32.9-99 57.4l-81.9-29.1c-12.5-4.4-26.5-0.7-35.1 9.5l-1.8 2.1c-34.8 41.1-61.6 87.5-79.7 137.9l-0.9 2.6c-4.5 12.5-0.8 26.5 9.3 35.2l66.3 56.6c-3.1 18.8-4.6 38-4.6 57.1 0 19.2 1.5 38.4 4.6 57.1L99 625.5c-10.1 8.6-13.8 22.6-9.3 35.2l0.9 2.6c18.1 50.4 44.9 96.9 79.7 137.9l1.8 2.1c8.6 10.1 22.5 13.9 35.1 9.5l81.9-29.1c29.8 24.5 63.1 43.9 99 57.4l15.8 85.4c2.4 13.1 12.7 23.3 25.8 25.7l2.7 0.5c26.1 4.7 52.8 7.1 79.5 7.1 26.7 0 53.5-2.4 79.5-7.1l2.7-0.5c13.1-2.4 23.4-12.6 25.8-25.7l15.7-85c36.2-13.6 69.7-32.9 99.7-57.6l81.3 28.9c12.5 4.4 26.5 0.7 35.1-9.5l1.8-2.1c34.8-41.1 61.6-87.5 79.7-137.9l0.9-2.6c4.5-12.3 0.8-26.3-9.3-35zM788.3 465.9c2.5 15.1 3.8 30.6 3.8 46.1s-1.3 31-3.8 46.1l-6.6 40.1 74.7 63.9c-11.3 26.1-25.6 50.7-42.6 73.6L721 702.8l-31.4 25.8c-23.9 19.6-50.5 35-79.3 45.8l-38.1 14.3-17.9 97c-28.1 3.2-56.8 3.2-85 0l-17.9-97.2-37.8-14.5c-28.5-10.8-55-26.2-78.7-45.7l-31.4-25.9-93.4 33.2c-17-22.9-31.2-47.6-42.6-73.6l75.5-64.5-6.5-40c-2.4-14.9-3.7-30.3-3.7-45.5 0-15.3 1.2-30.6 3.7-45.5l6.5-40-75.5-64.5c11.3-26.1 25.6-50.7 42.6-73.6l93.4 33.2 31.4-25.9c23.7-19.5 50.2-34.9 78.7-45.7l37.9-14.3 17.9-97.2c28.1-3.2 56.8-3.2 85 0l17.9 97 38.1 14.3c28.7 10.8 55.4 26.2 79.3 45.8l31.4 25.8 92.8-32.9c17 22.9 31.2 47.6 42.6 73.6L781.8 426l6.5 39.9z","p-id":"10890"}}),t("path",{attrs:{d:"M512 326c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176z m79.2 255.2C570 602.3 541.9 614 512 614c-29.9 0-58-11.7-79.2-32.8C411.7 560 400 531.9 400 502c0-29.9 11.7-58 32.8-79.2C454 401.6 482.1 390 512 390c29.9 0 58 11.6 79.2 32.8C612.3 444 624 472.1 624 502c0 29.9-11.7 58-32.8 79.2z","p-id":"10891"}})])},be=[],ye={name:"SettingIcon"},ve=ye,xe=m(ve,ge,be,!1,null,"5f121054",null),Ce=xe.exports,we=function(){var e=this,t=e._self._c;return e.columns.length?t("div",{staticClass:"column-settings-item-list"},[t("div",{staticClass:"title"},[e._v(e._s(e.title))]),t("div",{ref:"dragDropZoneRef",staticClass:"drag-drop-zone"},e._l(e.columns,function(r,o){return t("div",{key:r.prop,staticClass:"column-settings-item",class:{draggable:e.draggable,dragging:e.dragIndex===o},attrs:{draggable:e.draggable},on:{dragstart:t=>e.onDragstart(t,o),dragenter:function(t){return t.preventDefault(),e.onDragenter.apply(null,arguments)},dragover:function(t){return t.preventDefault(),(t=>e.onDragover(t,o)).apply(null,arguments)},dragleave:e.onDragleave,drop:t=>e.onDrop(t,o),dragend:e.onDragend}},[e.draggable?t("span",{staticClass:"icon icon-holder"},[t("HolderIcon")],1):e._e(),t("span",{staticClass:"switcher"}),t(e.dynamicComponent,e._g(e._b({tag:"component"},"component","el-checkbox"===e.dynamicComponent?{value:r.checkable,disabled:r.disabled}:{class:"toggleable-checkbox"},!1),"el-checkbox"===e.dynamicComponent?{change:t=>e.handleChange(t,r.prop)}:{}),[t("span",{staticClass:"label"},[e._v(e._s(r.label))]),t("ColumnAlignSettings",{attrs:{column:r}}),0===o&&e.dropIndex===o?t("div",{staticClass:"indicator head-indicator"}):e.dropIndex===o+1?t("div",{staticClass:"indicator tail-indicator"}):e._e()],1)],1)}),0)]):e._e()},_e=[],Pe=function(){var e=this,t=e._self._c;return t("svg",{staticClass:"icon",attrs:{t:"1768466031154",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4754","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1em",height:"1em",fill:"currentColor"}},[t("path",{attrs:{d:"M300 276.497a56 56 0 1 0 56-96.994 56 56 0 0 0-56 96.994z m0 284a56 56 0 1 0 56-96.994 56 56 0 0 0-56 96.994zM640 228a56 56 0 1 0 112 0 56 56 0 0 0-112 0z m0 284a56 56 0 1 0 112 0 56 56 0 0 0-112 0zM300 844.497a56 56 0 1 0 56-96.994 56 56 0 0 0-56 96.994zM640 796a56 56 0 1 0 112 0 56 56 0 0 0-112 0z","p-id":"4755"}})])},Ie=[],Se={name:"HolderIcon"},Re=Se,ke=m(Re,Pe,Ie,!1,null,"4567deaf",null),Ee=ke.exports,ze=function(){var e=this,t=e._self._c;return t("span",{staticClass:"icon-algin-group"},["left"!==e.column.fixed?[t("el-tooltip",{attrs:{content:"固定在列首",placement:"top"}},[t("VerticalAlignTopIcon",{nativeOn:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleAlgin("left")}}})],1)]:e._e(),"left"===e.column.fixed||"right"===e.column.fixed?[t("el-tooltip",{attrs:{content:"不固定",placement:"top"}},[t("VerticalAlginMiddleIcon",{nativeOn:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleAlgin()}}})],1)]:e._e(),"right"!==e.column.fixed?[t("el-tooltip",{attrs:{content:"固定在列尾",placement:"top"}},[t("VerticalAlginBottomIcon",{nativeOn:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleAlgin("right")}}})],1)]:e._e()],2)},Fe=[],Te=function(){var e=this,t=e._self._c;return t("svg",{staticClass:"icon",attrs:{t:"1768466090113",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5827","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1em",height:"1em"}},[t("path",{attrs:{d:"M955.968 100.864v66.944h-864V100.864h864zM528.064 215.616l150.784 150.784H565.76V928H490.24l0.128-561.6H377.216L528 215.68z",fill:"currentColor","p-id":"5828"}})])},Oe=[],Le={name:"VerticalAlignTopIcon"},je=Le,$e=m(je,Te,Oe,!1,null,"157c15ff",null),Ae=$e.exports,Ke=function(){var e=this,t=e._self._c;return t("svg",{staticClass:"icon",attrs:{t:"1768466105119",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6880","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1em",height:"1em"}},[t("path",{attrs:{d:"M955.968 928v-66.944h-864V928h864z m-427.904-114.752l150.784-150.784H565.76V100.864H490.24l0.128 561.6H377.216l150.848 150.784z",fill:"currentColor","p-id":"6881"}})])},De=[],Ve={name:"VerticalAlignBottomIcon"},Be=Ve,Me=m(Be,Ke,De,!1,null,"5f3f60a5",null),Ne=Me.exports,qe=function(){var e=this,t=e._self._c;return t("svg",{staticClass:"icon",attrs:{t:"1768466311335",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"9722","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1em",height:"1em",fill:"currentColor"}},[t("path",{attrs:{d:"M512 614.4l-153.6 153.6 102.4 0 0 204.8 102.4 0 0-204.8 102.4 0L512 614.4zM665.6 256l-102.4 0L563.2 51.2 460.8 51.2l0 204.8L358.4 256l153.6 153.6L665.6 256zM921.6 512c0-28.3136-2.4576-51.2-30.72-51.2L133.12 460.8C104.8576 460.8 102.4 483.6864 102.4 512c0 28.2112 2.4576 51.2 30.72 51.2L890.88 563.2C919.1424 563.2 921.6 540.2112 921.6 512z","p-id":"9723"}})])},Ue=[],He={name:"VerticalAlignMiddleIcon"},We=He,Je=m(We,qe,Ue,!1,null,"5047af18",null),Xe=Je.exports,Ze={name:"ColumnAlginSettings",inject:["onColumnSettingsChange"],components:{VerticalAlignTopIcon:Ae,VerticalAlginMiddleIcon:Xe,VerticalAlginBottomIcon:Ne},props:{column:{type:Object,default:()=>({})}},methods:{handleAlgin(e){const{prop:t}=this.column;this.onColumnSettingsChange({event:"align",prop:t,fixed:e})}}},Ye=Ze,Ge=m(Ye,ze,Fe,!1,null,"25fd06be",null),Qe=Ge.exports,et={name:"ColumnSettingsItem",components:{HolderIcon:Ee,ColumnAlignSettings:Qe},inject:["onColumnSettingsChange"],props:{columns:{type:Array,required:!0,default:()=>[]},columnSettings:{type:Object}},computed:{title(){const{columns:e}=this;if(Array.isArray(e)&&e.length){const t=e[0].fixed;return"left"===t?"固定在左侧":"right"===t?"固定在右侧":"不固定"}return""},draggable(){return this.columnSettings.draggable&&this.columns?.length>1},dynamicComponent(){return this.columnSettings.checkable?"el-checkbox":"span"}},data(){return{dragIndex:-1,dropIndex:-1}},methods:{handleChange(e,t){this.onColumnSettingsChange({event:"check",checked:e,prop:t})},getCursorPos(e){const t=e.target.getBoundingClientRect(),r=e.clientY-t.top,o=r<t.height/2?"top":"bottom";return o},getDropIndex(e,t){const r=this.getCursorPos(e),o="top"===r?t:t+1,n=this.dragIndex<t?"down":"up";if(o===this.dragIndex)return-1;const i=1===Math.abs(o-this.dragIndex);return i&&"down"===n?-1:o},onDragstart(e,t){e.dataTransfer.effectAllowed="move",e.dataTransfer.dropEffect="move",this.dragIndex=t},onDragenter(e){-1===this.dragIndex?e.dataTransfer.dropEffect="none":e.dataTransfer.dropEffect="move"},onDragover(e,t){this.dragIndex<0?e.dataTransfer.dropEffect="none":this.dragIndex!==t?this.dropIndex=this.getDropIndex(e,t):this.dropIndex=-1},onDragleave(e){const t=this.$refs.dragDropZoneRef;t.contains(e.relatedTarget)||(this.dropIndex=-1)},onDrop(e,t){if(this.dragIndex===t)return void(this.dropIndex=-1);const r=this.getDropIndex(e,t);if(r>-1){const{columns:e}=this,t=e[this.dragIndex].prop,o=r===this.columns.length,n=o?e[r-1].prop:e[r].prop;this.onColumnSettingsChange({event:"drop",fromProp:t,toProp:n,isAfter:o})}},onDragend(){this.dragIndex=-1,this.dropIndex=-1}}},tt=et,rt=m(tt,we,_e,!1,null,"bb9b3504",null),ot=rt.exports,nt={name:"ColumnSettings",components:{SettingIcon:Ce,ColumnSettingsItem:ot},inject:["onColumnSettingsChange"],props:{columns:{type:Array,required:!0},columnSettings:{type:Object}},computed:{leftFixedColumns(){return this.columns.filter(e=>"left"===e.fixed)},noFixedColumns(){return this.columns.filter(e=>"left"!==e.fixed&&"right"!==e.fixed)},rightFixedColumns(){return this.columns.filter(e=>"right"===e.fixed)},checkAll(){return this.columns.length===this.columns.filter(e=>e.checkable).length},isIndeterminate(){return!this.checkAll&&this.columns.filter(e=>!e.disabled&&e.checkable).length>0}},data(){return{}},methods:{handleChange(e){this.onColumnSettingsChange({event:"checkAll",checked:e})},handleReset(){this.onColumnSettingsChange({event:"reset"})}}},it=nt,st=m(it,fe,he,!1,null,"7e72f8a5",null),lt=st.exports,at={name:"ProTable",components:{ProFormItem:_,CustomRender:b,ArrowIcon:me,ColumnSettings:lt},provide(){if(this.columnSettings)return{onColumnSettingsChange:this.onColumnSettingsChange}},props:{search:{type:[Boolean,Object],default:!0},className:{type:String},dataSource:{type:Array},loading:{type:Boolean},total:{type:Number,default:0},tableProps:{type:Object,default:()=>({})},tableEvents:{type:Object,default:()=>({})},columns:{type:Array,required:!0,default:()=>[]},paginationProps:{type:Object,default:()=>({})},paginationMapping:{type:Object,default:()=>({})},initialValues:{type:Object,default:()=>({})},defaultSize:{type:String,validator:function(e){return["medium","small","mini"].includes(e)}},manualRequest:{type:Boolean,default:!1},columnSettings:{type:[Boolean,Object],default:!0}},computed:{searchProps(){const{search:e}=this;if(e){const t={searchText:"查询",resetText:"重置",labelWidth:"80px",rowProps:{gutter:8},colProps:oe,collapsed:!0,defaultExpandedRows:2};return"object"===typeof e?{...t,...this.search,collapsed:e.collapsed??e.defaultCollapsed??t.collapsed}:{...t}}return!1},formItems(){const{columns:e}=this;return e.filter(e=>!e.hideInSearch&&(!!e.valueType||e.renderField)).sort((e,t)=>t.order-e.order).map(e=>{const{label:t,prop:r,formItemProps:o={},renderLabel:n,valueType:i,renderField:s,fieldProps:l={},fieldEvents:a,initialValue:c}=e;return o.label=o.label||t,o.prop=o.prop||r,T(l,i),O(e,this.cachedOptions),L(l,e,this.cachedOptions),{...o,renderLabel:n,valueType:i,renderField:s,fieldProps:l,fieldEvents:a,options:e.options,initialValue:c}})},totalSearchCount(){return this.formItems.length},normalizedColumns(){const{columns:e,initializedColumnSettings:t,columnSettingsRule:r}=this;let o=e.filter(e=>!e.hideInTable).map(e=>{const{formItemProps:t,renderLabel:r,valueType:o,renderField:n,fieldProps:i,fieldEvents:s,options:l,valueEnum:a,optionLoader:c,initialValue:d,order:u,hideInSearch:p,renderCellHeader:m,renderCell:f,disabled:h,key:g,...b}=e;return{...b,nonElColumnProps:{valueEnum:a,renderCellHeader:m,renderCell:f,key:g,disabled:h}}});t&&r?.length&&(o=o.map(e=>{const t=r.find(t=>(e.prop||e.nonElColumnProps.key)===t.prop);if(t){const{checkable:r,fixed:o,index:n}=t;return e.nonElColumnProps={...e.nonElColumnProps,checkable:r,index:n},{...e,fixed:o}}return e}));const{draggable:n,checkable:i}=t;return n&&o.sort((e,t)=>e.nonElColumnProps.index-t.nonElColumnProps.index),i&&(o=o.filter(e=>e.nonElColumnProps.checkable)),o},settingColumns(){const{columnSettings:e}=this;if(!e)return[];const{columnSettingsRule:t,columns:r}=this;return t.map(e=>{const t=r.find(t=>e.prop===(t.prop||t.key));if(t){const{label:r,disabled:o}=t;return{...e,label:r,disabled:o}}return e})},initializedColumnSettings(){const{columnSettings:e}=this;if(e){const t={resetText:"重置",settingText:"列设置",draggable:!0,checkable:!0};return"object"===typeof e?{...t,...e}:t}return!1},initializedTableProps(){const{tableProps:e,defaultSize:t}=this;return{size:t,...e}},initializedTableEvents(){return{"sort-change":this.sortChange,...this.tableEvents}},initializedPaginationProps(){return{"page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper","hide-on-single-page":!0,...this.paginationProps,"current-page":this.pageNum,"page-size":this.pageSize,total:this.total}}},data(){return{cachedOptions:{},form:this.initForm(),showExpandToggle:!1,searchColConfig:oe,collapsed:!0,searchCount:0,tableKey:1,pageNum:1,pageSize:this.paginationProps["page-size"]||10,columnSettingsRule:[]}},watch:{totalSearchCount(){this.calculateSearchLayout()},"search.collapsed":function(e){e!==this.collapsed&&this.handleCollapse()}},created(){this.getOptions(),this.manualRequest||this.handleSearch(),this.columnSettings&&(this.columnSettingsRule=this.initializeColumnSettingsRule())},mounted(){const e=this.isResponsive();this.calculateSearchLayout(e),e&&(this.debounceResize=le(this.resize),window.addEventListener("resize",this.debounceResize))},methods:{getOptions(){const{columns:e}=this;for(const t of e){const{prop:e,fieldProps:r={},optionLoader:o}=t;o&&"function"===typeof o&&o().then(t=>{const o=r.prop||e;this.cachedOptions={...this.cachedOptions,[o]:t}})}},initForm(){const{columns:e}=this;if(!e.length)return{};const t=e.filter(e=>!!e.valueType).reduce((e,t)=>{const{prop:r,fieldProps:o={},initialValue:n}=t,i=o.prop||r;return i?{...e,[i]:n}:e},{});return{...this.initialValues,...t}},isResponsive(){const{searchProps:{colProps:e}}=this,t=Object.keys(e);return t.some(e=>ne.includes(e))},calculateSearchLayout(e=!1){const{searchProps:{colProps:t,defaultExpandedRows:r},totalSearchCount:o}=this;this.cachedSpanPerField=e?se(t):t.span||8,this.maxVisibleFields=Math.floor(re/this.cachedSpanPerField*r)-1,this.showExpandToggle=o>this.maxVisibleFields,this.showExpandToggle&&(this.collapsed=this.searchProps.collapsed),this.updateSearchLayout()},updateSearchLayout(){const{searchProps:{colProps:e},cachedSpanPerField:t}=this;this.searchCount=this.showExpandToggle&&this.collapsed?this.maxVisibleFields:this.totalSearchCount;const r=re-t*this.searchCount%re,o=r-t;this.searchColConfig={...e,offset:o}},resize(){this.calculateSearchLayout(!0)},handleCollapse(){this.collapsed=!this.collapsed,this.$emit("onCollapse",this.collapsed),this.showExpandToggle&&this.updateSearchLayout()},getParams(){const{pageNum:e,pageSize:t,paginationMapping:{pageKey:r,sizeKey:o}}=this;return{...this.form,[r||"pageNum"]:e,[o||"pageSize"]:t}},handleReset(){this.form=this.initForm(),this.pageNum=1,this.$emit("onParams",this.getParams()),this.$emit("onReset")},handleSearch(){this.pageNum=1;const e=this.getParams();this.$emit("onParams",e),this.$emit("onSubmit",e)},reload(e=!0){e&&(this.pageNum=1),this.$emit("onParams",this.getParams())},sortChange({prop:e,order:t}){this.pageNum=1,this.$emit("onParams",{...this.getParams(),prop:e,order:t})},handleCurrentChange(e){this.pageNum=e,this.$emit("onParams",this.getParams())},handleSizeChange(e){this.pageSize=e,this.pageNum=1,this.$emit("onParams",this.getParams())},getTableRef(){return this.$refs.tableRef},initializeColumnSettingsRule(){return this.columns.filter(e=>!e.hideInTable&&(e.prop||e.key)).map((e,t)=>{const{prop:r,key:o,fixed:n}=e;return{prop:r||o,fixed:n,checkable:!0,index:t}})},getUID(){return z()},checkAllRule(e){this.columnSettingsRule=this.columnSettingsRule.map(t=>{const r=this.columns.find(e=>(e.prop||e.key)===t.prop);return r?{...t,checkable:r.disabled?t.checkable:e}:t})},checkRule(e,t){const{columnSettingsRule:r}=this,o=r.findIndex(t=>t.prop===e);-1!==o&&r.splice(o,1,{...r[o],checkable:t})},handleAlignRule(e,t){const{columnSettingsRule:r}=this,o=r.findIndex(t=>t.prop===e);if(-1!==o){const e=r[o];r.splice(o,1,{...e,fixed:t})}},handleResetRule(){this.columnSettingsRule=this.initializeColumnSettingsRule()},handleDropRule(e,t,r=!1){const{columnSettingsRule:o}=this,n=o.findIndex(t=>(t.prop||t.key)===e);if(-1===n)return;const i=o.findIndex(e=>(e.prop||e.key)===t);if(-1===i)return;const s=n>i,l=s?i:n+1,a=s?n:r?i+1:i;for(let d=l;d<a;++d){const e=o[d];o.splice(d,1,{...e,index:s?e.index+1:e.index-1})}const c=o[n];s?(o.splice(n,1),o.splice(i,0,{...c,index:i})):(o.splice(i,0,{...c,index:i}),o.splice(n,1))},doLayout(){this.$nextTick(()=>{this.$refs.tableRef?.doLayout()})},onColumnSettingsChange(e){const{event:t,prop:r,checked:o,fixed:n,fromProp:i,toProp:s,isAfter:l}=e;switch(t){case"checkAll":this.checkAllRule(o),this.doLayout();break;case"check":this.checkRule(r,o),this.doLayout();break;case"align":this.handleAlignRule(r,n);break;case"reset":this.handleResetRule(),this.tableKey=this.getUID();break;case"drop":this.handleDropRule(i,s,l),this.tableKey=this.getUID();break;default:break}}},beforeDestroy(){window.removeEventListener("resize",this.resize),this.debounceResize?.cancel()}},ct=at,dt=m(ct,Q,ee,!1,null,"5d0503a8",null),ut=dt.exports;ut.install=function(e){e.component(ut.name,ut)};var pt,mt,ft=ut,ht=function(){var e=this,t=e._self._c;return t(e.formRef?"fragment":"el-form",e._b({tag:"component"},"component",e.getDynamicProps,!1),[t("el-table-prepend",e._g(e._b({directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"editableProTableRef",staticClass:"editable-pro-table",class:e.className,attrs:{data:e.form[e.name]},scopedSlots:e._u(["top"!==e.initializedCreatorProps.position||e.exceedsMax?null:{key:"prepend",fn:function(){return[t("div",{staticClass:"btn-add-box"},[t("RecordCreator",{attrs:{recordCreatorProps:e.initializedCreatorProps,size:e.defaultSize},nativeOn:{click:function(t){return e.addEditRecord(null)}}})],1)]},proxy:!0}],null,!0)},"el-table-prepend",e.initializedTableProps,!1),e.tableEvents),e._l(e.initializedColumns,function(r,o){return t("el-table-column",e._b({key:r.prop||r.key,scopedSlots:e._u([r.renderCellHeader?{key:"header",fn:function(e){return[t("CustomRender",{attrs:{render:()=>r.renderCellHeader(e)}})]}}:null,r.valueType||r.renderField?{key:"default",fn:function(o){return["option"===r.valueType?[t("Editable",{attrs:{editable:e.initializedEditable,action:{cancelEditable:e.cancelEditable,startEditable:e.startEditable,addEditRecord:e.addEditRecord},validateRow:e.validateRow,recordKey:o.row[e.rowKey],scope:o,name:e.name,render:e=>r.renderCell(o,e),newLineRecordCache:e.newLineRecordCache,preEditRows:e.preEditRows,defaultSize:e.defaultSize},on:{delete:e.filterByRecordKey,cancel:e.deleteOrResetRow}})]:[t("RenderCell",{attrs:{editable:e.initializedEditable,column:r,name:e.name,recordKey:o.row[e.rowKey],scope:o,cachedOptions:e.cachedOptions,preEditRows:e.preEditRows},scopedSlots:e._u([{key:r.prop,fn:function(t){return[e._t(r.prop,null,null,t)]}}],null,!0)})]]}}:null],null,!0)},"el-table-column",e.getColumnProps(r,o),!1))}),1),"bottom"!==e.initializedCreatorProps.position||e.exceedsMax?e._e():t("RecordCreator",{attrs:{recordCreatorProps:e.initializedCreatorProps,size:e.defaultSize},nativeOn:{click:function(t){return e.addEditRecord(null)}}})],1)},gt=[],bt=o(309),yt=o.n(bt),vt=function(){var e=this,t=e._self._c;return t("el-button",e._b({staticClass:"btn-add",style:e.recordCreatorProps.style,attrs:{icon:"el-icon-plus"}},"el-button",e.initializedButtonProps,!1),[e._v(" "+e._s(e.recordCreatorProps.creatorButtonText)+" ")])},xt=[],Ct={name:"RecordCreator",props:{recordCreatorProps:{type:[Boolean,Object],required:!0},size:{type:String}},computed:{initializedButtonProps(){const{size:e,recordCreatorProps:{buttonProps:t={}}}=this;return{plain:!0,...t,size:e}}}},wt=Ct,_t=m(wt,vt,xt,!1,null,"162f12bc",null),Pt=_t.exports,It=function(){var e=this,t=e._self._c;return t("Fragment",[e.isEditable?t("FormItem",{attrs:{formItem:e.formItem,formItemProp:e.formItemProp,form:e.row,name:e.name,recordKey:e.recordKey,index:e.index},scopedSlots:e._u([{key:e.formItem.prop,fn:function(){return[e._t(e.formItem.prop,null,null,{form:e.row,formItem:e.formItem,recordKey:e.recordKey,index:e.index})]},proxy:!0}],null,!0)}):[t("el-form-item",{staticClass:"editable-form-item",attrs:{prop:e.formItemProp}},[e.column.renderCell?t("CustomRender",{attrs:{render:()=>e.column.renderCell(e.scope)}}):t("span",{class:{"text-ellipsis":e.column["show-overflow-tooltip"]}},[e._v(e._s(e.value??"-"))])],1)]],2)},St=[],Rt=function(){var e=this,t=e._self._c;return t("el-form-item",e._b({staticClass:"editable-form-item",attrs:{prop:e.formItemProp,label:""}},"el-form-item",e.normalizedFormItem,!1),[e.formItem.renderField?t("CustomRender",{attrs:{render:()=>e.formItem.renderField({form:e.form,formItem:e.formItem,recordKey:e.recordKey,index:e.index})}}):"slot"===e.formItem.valueType?e._t(e.formItem.prop):t(`el-${e.formItem.valueType}`,e._g(e._b({tag:"component",model:{value:e.form[e.formItem.prop],callback:function(t){e.$set(e.form,e.formItem.prop,t)},expression:"form[formItem.prop]"}},"component",e.formItem.fieldProps,!1),e.normalizedFieldEvents),["select"===e.formItem.valueType?[e.formItem.options?.[0]?.options?e._l(e.formItem.options,function(r){return t("el-option-group",e._b({key:r.label},"el-option-group",r,!1),e._l(r.options,function(r){return t("el-option",e._b({key:r.value},"el-option",r,!1))}),1)}):e._l(e.formItem.options,function(r){return t("el-option",e._b({key:r.value},"el-option",r,!1))})]:e.groups.includes(e.formItem.valueType)?e._l(e.formItem.options,function(r){return t(e.selection[e.formItem.valueType],{key:r.value,tag:"component",attrs:{label:r.value}},[e._v(" "+e._s(r.label)+" ")])}):e._e()],2)],2)},kt=[],Et={name:"FormItem",components:{CustomRender:b},props:{formItem:{type:Object,required:!0},form:{type:Object,required:!0},name:{type:String},recordKey:{type:[Number,String]},index:{type:Number},formItemProp:{type:String}},computed:{normalizedFormItem(){const{valueType:e,renderField:t,fieldProps:r,fieldEvents:o,options:n,valueEnum:i,optionLoader:s,initialValue:l,colProps:a,...c}=this.formItem;return c},normalizedFieldEvents(){const{formItem:{fieldEvents:e}}=this;if(!e)return;const t={},{recordKey:r,form:o,index:n}=this;for(const i in e){const s=(...t)=>e[i]?.(...t,{recordKey:r,row:o,index:n});t[i]=s}return t}},data(){return{groups:["radio-group","checkbox-group"],selection:{"radio-group":"el-radio","checkbox-group":"el-checkbox"}}}},zt=Et,Ft=m(zt,Rt,kt,!1,null,"1ac7c73e",null),Tt=Ft.exports,Ot={name:"RenderCell",components:{FormItem:Tt,CustomRender:b},props:{editable:{type:Object,required:!0},column:{type:Object,required:!0},scope:{type:Object},name:{type:String,required:!0},recordKey:{type:[String,Number]},cachedOptions:{type:Object},preEditRows:{type:Map}},computed:{formItem(){const{column:e,column:{prop:t,formItemProps:r={},valueType:o,renderField:n,fieldProps:i={},fieldEvents:s}}=this;return T(i,o),O(e,this.cachedOptions),L(i,e,this.cachedOptions),{...r,prop:t,valueType:o,renderField:n,fieldProps:i,fieldEvents:s,options:e.options}},row(){return this.scope.row},index(){return this.scope.$index},formItemProp(){const{formItem:{prop:e},name:t,index:r}=this;return`${t}.${r}.${e}`},isEditable(){const{editable:{editableKeys:e},recordKey:t,formItem:{prop:r},column:{readonly:o,editable:n}}=this,i=this.preEditRows.get(this.recordKey)?.[r];return e?.some(e=>t===e)&&!0!==o&&(!n||n?.(i,this.row,this.index))},value(){const{column:{formatter:e},formItem:t,scope:r,row:o,index:n}=this,{prop:i,valueType:s,options:l,valueEnum:a}=t,c=o[i];if(e)return e(o,r.column,c,n);if("select"===s){if(a)return a instanceof Map?a.get(c):a[c];{const e=(l||[]).reduce((e,t)=>({...e,[t.value]:t.label}),{});return e[c]}}return c}}},Lt=Ot,jt=m(Lt,It,St,!1,null,"5943cebf",null),$t=jt.exports,At={name:"Editable",props:{editable:{type:Object,required:!0},action:{type:Object,required:!0},validateRow:{type:Function},recordKey:{type:[String,Number]},render:{type:Function,required:!0},scope:{type:Object},newLineRecordCache:{type:Object},name:{type:String},preEditRows:{type:Map},defaultSize:{type:String}},computed:{isEditable(){const{editable:{editableKeys:e},recordKey:t}=this;return e?.some(e=>t===e)},isNewLineRecordCache(){return this.newLineRecordCache?.options.recordKey===this.recordKey}},data(){return{saveLoading:!1,visible:!1,deleteLoading:!1}},methods:{async save(){const{validateRow:e,scope:{row:t,$index:r},recordKey:o}=this,n=await e(r);if(n)try{this.saveLoading=!0;const e=await(this.editable.onSave?.(o,t,this.preEditRows.get(o)));if(this.saveLoading=!1,!1===e)return;this.action.cancelEditable(o,t)}catch(i){this.saveLoading=!1,console.error("err",i)}},async delete(){try{this.deleteLoading=!0;const{scope:{row:e},recordKey:t}=this,r=await(this.editable.onDelete?.(t,e));if(this.deleteLoading=!1,!1===r)return;this.visible=!1,await this.action.cancelEditable(t,e),this.$emit("delete",t)}catch(e){this.deleteLoading=!1,console.error("err",e)}},async cancel(){try{const{recordKey:e,scope:{row:t,$index:r}}=this;await this.action.cancelEditable(e,t),this.$emit("cancel",e,r)}catch(e){console.error("err",e)}}},render:function(e){const{saveText:t,deleteText:r,cancelText:o,deletePopconfirmMessage:n}=this.editable,{defaultSize:i}=this,s={save:e("el-button",{class:"btn-save",attrs:{type:"text",size:i,loading:this.saveLoading},on:{click:this.save}},[t]),delete:e("el-popover",{attrs:{placement:"top","popper-class":"delete-popover-message",trigger:"click",value:this.visible},on:{input:e=>this.visible=e}},[e("p",[e("i",{class:"el-icon-warning",style:"color: #ffad00; margin-right: 8px"}),e("span",[n])]),e("div",{style:"text-align: right; margin-left: 22px"},[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:()=>{this.visible=!1}}},["取消"]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:this.delete}},["确定"])]),e("el-button",{slot:"reference",attrs:{type:"text",size:i,loading:this.deleteLoading}},[r])]),cancel:e("el-button",{class:"btn-cancel",attrs:{type:"text",size:i},on:{click:this.cancel}},[o])},{editable:{editableKeys:l,onChange:a,onSave:c,onDelete:d,onCancel:u,actionRender:p},scope:{row:m},isNewLineRecordCache:f}=this,{recordKey:h,scope:{$index:g},action:{cancelEditable:b,addEditRecord:y},name:v,newLineRecordCache:x}=this,C={editableKeys:l,setEditableRowKeys:e=>a?.(e),recordKey:h,preEditRow:this.preEditRows.get(h),index:g,onSave:c,onDelete:d,onCancel:u,cancelEditable:b,newLineConfig:x,saveText:t,deleteText:r,cancelText:o,deletePopconfirmMessage:n,addEditRecord:y,tableName:v},w=[s.save,!f&&s.delete,s.cancel].filter(Boolean),_="function"===typeof p?p(m,C,s):w;return e("Fragment",[this.isEditable?_:this.render(this.action)])}},Kt=At,Dt=m(Kt,pt,mt,!1,null,"39818f6b",null),Vt=Dt.exports,Bt={name:"EditableProTable",components:{ElTablePrepend:yt(),RecordCreator:Pt,CustomRender:b,RenderCell:$t,Editable:Vt},inject:{formRef:{from:"elForm",default:null}},props:{dataSource:{type:Array,required:!0,default:()=>[]},recordCreatorProps:{type:[Boolean,Object],default:!0},maxLength:{type:Number},editable:{type:Object},rowKey:{type:String},name:{type:String,default:"dataSource"},className:{type:String},loading:{type:Boolean},tableProps:{type:Object},tableEvents:{type:Object},columns:{type:Array,required:!0,default:()=>[]},defaultSize:{type:String,validator:function(e){return["medium","small","mini"].includes(e)}},sticky:{type:Boolean,default:!0}},computed:{getDynamicProps(){const{formRef:e,form:t,defaultSize:r}=this;if(!e)return{ref:"formRef",model:t,size:r}},initializedCreatorProps(){const{recordCreatorProps:e}=this;if(e){const t={position:"bottom",newRecordType:"cache",creatorButtonText:"添加一行数据",onlyAddOneLineAlertMessage:"只能新增一行"};return"object"===typeof e?{...t,...e}:t}return!1},exceedsMax(){const{maxLength:e}=this;return"number"===typeof e&&this.form[this.name].length>=e},initializedEditable(){const e={type:"single",saveText:"保存",deleteText:"删除",cancelText:"取消",deletePopconfirmMessage:"删除此项？",onlyOneLineEditorAlertMessage:"只能同时编辑一行"};return{...e,...this.editable}},initializedTableProps(){const{rowKey:e,tableProps:t={},defaultSize:r}=this;return{...t,rowKey:e,size:r,"cell-style":e=>this.getCellStyle(e,t["cell-style"]),"header-cell-style":e=>this.getCellStyle(e,t["header-cell-style"])}},initializedColumns(){return this.columns.filter(e=>!e.hideInTable)},calculateOffset(){const e={},{initializedColumns:t,sticky:r}=this;let o=0,n=-1;for(let l=0;l<t.length;l++){const i=t[l],s=!1!==r&&"left"===i.fixed;s&&(n=l,e[l]=o,o+=i.width||i.minWidth)}let i=0,s=-1;for(let l=t.length-1;l>=0;l--){const o=t[l],n=!1!==r&&"right"===o.fixed;n&&(s=l,e[l]=i,i+=o.width||o.minWidth)}return{offset:e,leftIndex:n,rightIndex:s}}},data(){return{cachedOptions:{},form:{[this.name]:this.dataSource},newLineRecordCache:void 0,preEditRows:new Map}},created(){this.getOptions()},watch:{dataSource(e){this.form[this.name]=e}},methods:{getOptions(){for(const e of this.columns){const{prop:t,optionLoader:r}=e;"function"===typeof r&&r().then(e=>{this.cachedOptions={...this.cachedOptions,[t]:e}})}},addEditRecord(e,t){const{initializedCreatorProps:{onlyAddOneLineAlertMessage:r}}=this;if(this.newLineRecordCache)return void this.$message.warning(r);if(!this.validateCanStartEdit())return;const{form:o,name:n,rowKey:i}=this,{initializedCreatorProps:{position:s,newRecordType:l,record:a}}=this,c=o[n],d={position:s,newRecordType:l,...t||{}},u="top"===d.position?c.length:0;e=e??a;const p="function"===typeof e?e(u,c):e;if(!p[i])return void console.error("Error: 请设置 recordCreatorProps.record 并返回一个唯一的key");"dataSource"!==d.newRecordType?this.newLineRecordCache={defaultValue:JSON.parse(JSON.stringify(p)),options:{...d,recordKey:p[i]}}:this.newLineRecordCache=void 0,"top"===d.position?c.unshift(p):c.push(p);const{initializedEditable:{editableKeys:m,onChange:f}}=this,h=[...m,p[i]],g=c.filter(e=>m.includes(e[i]));f?.(h,g)},getColumnProps(e,t){const{formItemProps:r,renderLabel:o,valueType:n,renderField:i,fieldProps:s,fieldEvents:l,options:a,valueEnum:c,optionLoader:d,renderCellHeader:u,renderCell:p,editable:m,readonly:f,key:h,...g}=e,{sticky:b}=this,y=(e,t)=>t?"left"===e?"editable-pro-table__fixed-left":"right"===e?"editable-pro-table__fixed-right":"":"";let v=e["class-name"]||"";return e.fixed&&b&&(v+=" "+y(e.fixed,b)),this.calculateOffset.leftIndex===t?v+=" editable-pro-table__fixed-start-shadow":this.calculateOffset.rightIndex===t&&(v+=" editable-pro-table__fixed-end-shadow"),{...g,fixed:e.fixed&&b?void 0:e.fixed,"class-name":v}},getValidateFields(e){return this.columns.filter(e=>e.valueType&&"option"!==e.valueType||e.renderField).map(t=>`${this.name}.${e}.${t.prop}`)},validateRow(e){return new Promise(async t=>{const r=this.getValidateFields(e),o=r.map(e=>new Promise(t=>{this.getFormRef()?.validateField(e,e=>{t(!e)})})),n=await Promise.all(o);t(!n.some(e=>!e))})},validateCanStartEdit(){const{initializedEditable:{type:e,editableKeys:t,onlyOneLineEditorAlertMessage:r}}=this;return!t.length||"single"!==e||(this.$message.warning(r),!1)},clearEditableState(e){const{initializedEditable:{editableKeys:t,onChange:r}}=this;if(!t.includes(e))return!0;const o=t.filter(t=>t!==e);r?.(o)},clearNewLineCache(e){this.newLineRecordCache?.options.recordKey===e&&(this.newLineRecordCache=null)},async cancelEditable(e,t){try{const r=this.preEditRows.get(e);await(this.editable.onCancel?.(e,t,r)),this.clearEditableState(e),this.clearNewLineCache(e)}catch(r){console.error("err",r)}return!0},findRecordByKey(e){const t=this.form[this.name],r=t.find(t=>t[this.rowKey]===e);return JSON.parse(JSON.stringify(r))},startEditable(e){if(!this.validateCanStartEdit())return!1;const{initializedEditable:{editableKeys:t,onChange:r}}=this,o=t?.some(t=>t===e);return o||(r?.([...t,e]),this.preEditRows.set(e,this.findRecordByKey(e))),!0},filterByRecordKey(e){const{form:t,name:r,rowKey:o}=this,n=t[r],i=n.findIndex(t=>t[o]===e);-1!==i&&n.splice(i,1)},deleteOrResetRow(e,t){const{initializedCreatorProps:{newRecordType:r}}=this,o=this.preEditRows.get(e);if(o){const{form:t,name:r,rowKey:n}=this,i=t[r],s=i.findIndex(t=>t[n]===e);-1!==s&&i.splice(s,1,o)}else if("dataSource"!==r)this.filterByRecordKey(e);else{const{initializedCreatorProps:{record:e},form:r,name:o,rowKey:n}=this,i=r[o],s="function"===typeof e?e(t,i):e;delete s[n],this.setRowData(t,s)}},getFormRef(){return this.formRef||this.$refs.formRef},validate(){return this.getFormRef()?.validate},reset(){return this.getFormRef()?.resetFields},getTableRef(){return this.$refs.editableProTableRef},getRowData(e){const t=this.form[this.name];return"number"===typeof e&&e<t.length?t[e]:t.find(t=>t[this.rowKey]===e)},getRowsData(){return this.form[this.name]},setRowData(e,t){const r=this.form[this.name];if("number"===typeof e&&e<r.length)console.log({...r[e],...t}),r.splice(e,1,{...r[e],...t});else{const o=r.findIndex(t=>t[this.rowKey]===e);-1!==o&&r.splice(o,1,{...r[o],...t})}},getCellStyle({row:e,column:t,rowIndex:r,columnIndex:o},n){const i=n?.({row:e,column:t,rowIndex:r,columnIndex:o}),s=this.getStickyStyle(o,this.initializedColumns[o].fixed);if("string"===typeof i){let e="";if(e+=i+";",s){const t=Object.entries(s).map(([e,t])=>`${e}: ${t};`);e+=t}return e}return i instanceof Object?{...i,...s||{}}:s},getStickyStyle(e,t){const r=this.calculateOffset.offset[e];if(void 0!==r)return{[t]:`${r}px`}}}},Mt=Bt,Nt=m(Mt,ht,gt,!1,null,"b718f0f2",null),qt=Nt.exports;qt.install=function(e){e.component(qt.name,qt)};var Ut=qt;const Ht=[B,G,ft,Ut],Wt=function(e){Wt.installed||(Ht.forEach(t=>{e.component(t.name,t)}),Wt.installed=!0)};"undefined"!==typeof window&&window.Vue&&Wt(window.Vue);var Jt={install:Wt,ProForm:B,DialogForm:G,ProTable:ft,EditableProTable:Ut},Xt=Jt;return n}()});
//# sourceMappingURL=index.umd.min.js.map